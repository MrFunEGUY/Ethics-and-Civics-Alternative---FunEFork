holding_garrison = {
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = holding_overlord_garrison
	base_cap_amount = 1

	category = army

	resources = {
		category = planet_holdings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
		produces = { ## ECAF
			ecaf_crew = @base_fortress_building_crew_production
		}
	}

	planet_modifier = {
		planet_crime_add = -10
		monthly_loyalty = 0.5
	}

	triggered_planet_modifier = {
		potential = {
			overlord_has_num_armies_on_planet = { NUM = 1 }
		}
		modifier = {
			planet_crime_add = -10
			pop_happiness = -0.05
			monthly_loyalty = 0.5
		}
	}

	triggered_planet_modifier = {
		potential = {
			overlord_has_num_armies_on_planet = { NUM = 2 }
		}
		modifier = {
			planet_crime_add = -20
			pop_happiness = -0.1
			monthly_loyalty = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			overlord_has_more_than_num_armies_on_planet = { NUM = 2 }
		}
		modifier = {
			planet_crime_add = -30
			pop_happiness = -0.15
			monthly_loyalty = 1.5
		}
	}

	triggered_desc = {
		text = holding_garrison_armies_desc
	}
}

holding_recruitment_office = {
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = holding_recruitment_office
	planet_limit = 1

	category = army

	resources = {
		category = planet_holdings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
		produces = { ## ECAF
			ecaf_crew = @base_fortress_building_crew_production
		}
	}

	potential = {
		owner = {
			is_wilderness_empire = no
			OR = {
				overlord = { has_valid_civic = civic_citizen_service }
				## ECAF
				overlord = { is_stratocracy = yes }
				overlord = { has_valid_civic = civic_stratocracy }
				overlord = { has_valid_civic = civic_martial_brotherhood }
			}
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_gestalt = no }
		}
		job_overlord_recruiter_add = 200
	}
	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_gestalt = yes }
		}
		job_overlord_recruiter_drone_add = 200
	}

	triggered_country_modifier = {
		country_naval_cap_add = 10
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_pacifist = yes }
		}
		monthly_loyalty = -0.5
	}
	triggered_desc = {
		text = job_overlord_recruiter_effect_desc
	}
	on_built = {
		planet = {
			planet_event = { id = subject.5010 days = 1800 }
		}
	}
}

holding_park_ranger_lodge = {
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = holding_park_ranger_lodge
	planet_limit = 1

	category = amenity

	resources = {
		category = planet_holdings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}

	potential = {
		owner = {
			OR = {
				AND = {
					NOT = { has_valid_civic = civic_environmentalist }
					overlord = { has_valid_civic = civic_environmentalist }
				}
				AND = { ## ECAF
					NOT = { has_valid_civic = civic_keepers_harmony }
					overlord = { has_valid_civic = civic_keepers_harmony }
				}
			}
			
		}
		NOR = {
			is_planet_class = pc_city
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			is_planet_class = pc_relic
		}
		is_artificial = no
	}

	allow = {
		custom_tooltip = {
			fail_text = no_free_district_for_ranger_lodge
			planet = {
				num_free_districts = {
					type = any
					value > 0
				}
			}
		}
		custom_tooltip = {
			fail_text = no_ranger_lodge_wilderness
			owner = { is_wilderness_empire = no }
		}
	}

	destroy_trigger = {
		OR = {
			is_planet_class = pc_city
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			is_planet_class = pc_relic
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_gestalt = no }
		}
		job_overlord_ranger_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_gestalt = yes }
		}
		job_overlord_ranger_drone_add = 100
	}

	on_built = {
		planet = {
			add_blocker = { type = d_nature_preserve_blocker }
		}
	}

	on_destroy = {
		planet = {
			if = {
				limit = { has_deposit = d_nature_preserve_blocker }
				remove_deposit = d_nature_preserve_blocker
			}
		}
	}
}

holding_knight_commandery = {
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_order_holding
	planet_limit = 1

	category = government

	resources = {
		category = planet_holdings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
		produces = { ## ECAF
			ecaf_crew = @base_fortress_building_crew_production
		}
	}

	potential = {
		owner = {
			is_wilderness_empire = no # implied by lack of Pops, but neater if made explicit
			overlord = {
				has_origin = origin_toxic_knights
				NOT = { has_country_flag = quest_abandoned }
			}
		}
	}

	allow = {
		exists = planet
		planet = {
			is_capital = yes
			pop_amount >= 5000
		}
	}

	destroy_trigger = {
		OR = {
			NOT = { exists = owner.overlord }
			owner.overlord = { NOT = { has_origin = origin_toxic_knights } }
		}
	}

	planet_modifier = {
		monthly_loyalty = -0.5
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_gestalt = no }
		}
		job_overlord_knight_add = 100
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_gestalt = yes }
		}
		job_overlord_knight_drone_add = 100
	}

	country_modifier = {
		country_naval_cap_add = 4
		knight_quest_progress_add = 0.025
	}
}