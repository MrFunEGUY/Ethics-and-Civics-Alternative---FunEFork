###############################
# Pop Faction Events
# By Maximilian Olbers
###############################
namespace = factions
# A faction is formed - filter toast or event
pop_faction_event = {
	hide_window = yes
	id = factions.0
	is_triggered_only = yes

	trigger = {
		NOT = {
			owner = {
				has_origin = origin_broken_shackles
			}
		}
	}

	immediate = {

		owner = {
			every_owned_planet = {
				every_owned_pop_group = {
					force_faction_evaluation = yes
				}
			}
			if = {
				limit = {
					NOT = {
						has_country_flag = first_faction
					}
				}
				set_country_flag = first_faction
				from = { pop_faction_event = { id = factions.1 } }
			}
			else = {
				from = {
					switch = {
						trigger = is_pop_faction_type
						traditionalist = {
							root.owner = {
								create_faction_formed_message = {
									FACTION_TYPE = MESSAGE_FACTION_TRADITIONALIST
									FACTION_INTRO = factions.1.desc.start_short
								}
							}
						}
						imperialist = {
							root.owner = {
								create_faction_formed_message = {
									FACTION_TYPE = MESSAGE_FACTION_IMPERIALIST
									FACTION_INTRO = factions.1.desc.start_short
								}
							}
						}
						supremacist = {
							root.owner = {
								create_faction_formed_message = {
									FACTION_TYPE = MESSAGE_FACTION_SUPREMACIST
									FACTION_INTRO = factions.1.desc.start_short
								}
							}
						}
						isolationist = {
							root.owner = {
								create_faction_formed_message = {
									FACTION_TYPE = MESSAGE_FACTION_ISOLATIONIST
									FACTION_INTRO = factions.1.desc.start_short
								}
							}
						}
						totalitarian = {
							root.owner = {
								create_faction_formed_message = {
									FACTION_TYPE = MESSAGE_FACTION_TOTALITARIAN
									FACTION_INTRO = factions.1.desc.start_short
								}
							}
						}
						progressive = {
							root.owner = {
								create_faction_formed_message = {
									FACTION_TYPE = MESSAGE_FACTION_PROGRESSIVE
									FACTION_INTRO = factions.1.desc.start_short
								}
							}
						}
						prosperity = {
							root.owner = {
								create_faction_formed_message = {
									FACTION_TYPE = MESSAGE_FACTION_PROSPERITY
									FACTION_INTRO = factions.1.desc.start_short
								}
							}
						}
						technologist = {
							root.owner = {
								create_faction_formed_message = {
									FACTION_TYPE = MESSAGE_FACTION_TECHNOLOGIST
									FACTION_INTRO = factions.1.desc.start_short
								}
							}
						}
						xenoist = {
							root.owner = {
								create_faction_formed_message = {
									FACTION_TYPE = MESSAGE_FACTION_XENOIST
									FACTION_INTRO = factions.1.desc.start_short
								}
							}
						}
						bankers = {
							root.owner = {
								create_faction_formed_message = {
									FACTION_TYPE = MESSAGE_FACTION_BANKER
									FACTION_INTRO = factions.1.desc.start_short
								}
							}
						}
						socialists = {
							root.owner = {
								create_faction_formed_message = {
									FACTION_TYPE = MESSAGE_FACTION_SOCIALIST
									FACTION_INTRO = factions.1.desc.start_short
								}
							}
						}
						manifesti = {
							root.owner = {
								create_faction_formed_message = {
									FACTION_TYPE = MESSAGE_FACTION_MANIFESTI
									FACTION_INTRO = factions.1.desc.start_short
								}
							}
						}
					}
				}
			}
		}
	}
}

# A faction is formed - toast
# A faction is formed - toast (standard version)
pop_faction_event = {
	id = factions.1
	title = factions.1.title
	desc = {
		trigger = {
			# Intro
			success_text = {
				text = factions.1.desc.start
				hidden:owner = { NOT = { has_origin = origin_unplugged } }
			}
			success_text = {
				text = factions.1.desc.unplugged_start
				hidden:owner = { has_origin = origin_unplugged }
			}
			text = newline
			# Body text (standard Factions with variants based on e.g. Origin)
			inline_script = {
				script = pop_faction_types/faction1_desc
				FACTION = imperialist
			}
			inline_script = {
				script = pop_faction_types/faction1_desc
				FACTION = isolationist
			}
			inline_script = {
				script = pop_faction_types/faction1_desc
				FACTION = progressive
			}
			inline_script = {
				script = pop_faction_types/faction1_desc
				FACTION = prosperity
			}
			inline_script = {
				script = pop_faction_types/faction1_desc
				FACTION = supremacist
			}
			inline_script = {
				script = pop_faction_types/faction1_desc
				FACTION = technologist
			}
			inline_script = {
				script = pop_faction_types/faction1_desc
				FACTION = totalitarian
			}
			inline_script = {
				script = pop_faction_types/faction1_desc
				FACTION = traditionalist
			}
			inline_script = {
				script = pop_faction_types/faction1_desc
				FACTION = xenoist
			}
			inline_script = {
				script = pop_faction_types/faction1_desc
				FACTION = socialists
			}
			inline_script = {
				script = pop_faction_types/faction1_desc
				FACTION = bankers
			}
			# Body text (other, exempt Factions)
			success_text = {
				text = factions.1.desc.manifesti
				is_pop_faction_type = manifesti
			}
			# Outro
			success_text = {
				hidden:owner = { NOT = { has_country_flag = first_faction } }
				text = factions.1.desc.firstfinisher
			}
		}
	}
	picture = GFX_evt_galactic_senate
	show_sound = event_factions
	is_triggered_only = yes

	option = {
		name = OK
		hidden_effect = {
			owner = {
				every_owned_planet = {
					every_owned_pop_group = {
						force_faction_evaluation = yes
					}
				}
			}
		}
	}
}

# Notification event - other empire shifts ethics.
country_event = {
	id = factions.2000
	title = factions.2000.title
	location = event_target:TargetFaction.Owner.capital_scope
	desc = {
		trigger = {
			text = factions.2000.desc.start
			text = newline
			success_text = {
				text = factions.2000.desc.bankers
				event_target:TargetFaction = {
					is_pop_faction_type = bankers
				}
			}
			success_text = {
				text = factions.2000.desc.socialists
				event_target:TargetFaction = {
					is_pop_faction_type = socialists
				}
			}
			success_text = {
				text = factions.2000.desc.imperialist
				event_target:TargetFaction = {
					is_pop_faction_type = imperialist
				}
			}
			success_text = {
				text = factions.2000.desc.isolationist
				event_target:TargetFaction = {
					is_pop_faction_type = isolationist
				}
			}
			success_text = {
				text = factions.2000.desc.progressive
				event_target:TargetFaction = {
					is_pop_faction_type = progressive
				}
			}
			success_text = {
				text = factions.2000.desc.prosperity
				event_target:TargetFaction = {
					is_pop_faction_type = prosperity
				}
			}
			success_text = {
				text = factions.2000.desc.supremacist
				event_target:TargetFaction = {
					is_pop_faction_type = supremacist
				}
			}
			success_text = {
				text = factions.2000.desc.technologist
				event_target:TargetFaction = {
					is_pop_faction_type = technologist
				}
			}
			success_text = {
				text = factions.2000.desc.totalitarian
				event_target:TargetFaction = {
					is_pop_faction_type = totalitarian
				}
			}
			success_text = {
				text = factions.2000.desc.traditionalist
				event_target:TargetFaction = {
					is_pop_faction_type = traditionalist
				}
			}
			success_text = {
				text = factions.2000.desc.xenoist
				event_target:TargetFaction = {
					is_pop_faction_type = xenoist
				}
			}
			success_text = {
				text = factions.2000.desc.manifesti
				event_target:TargetFaction = {
					is_pop_faction_type = manifesti
				}
			}
		}
	}
	picture = GFX_evt_alien_propaganda
	show_sound = event_factions
	is_triggered_only = yes
	option = {
		name = OK
	}
}